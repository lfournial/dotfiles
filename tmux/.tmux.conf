# Configuration {{{

# Fix tmux not using correct color scheme
# set -g default-terminal "screen-256color"
set -g default-terminal 'tmux-256color'
set -as terminal-overrides ',xterm-256color:RGB:sitm=\E[3m'

# Disable tmux from overriding default terminal cursor
set -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'

# Increase scroll back history
set -g history-limit 5000

# use vi key bindings
# setw -g mode-keys vi
set-window-option -g mode-keys vi

# Disable mouse
set -g mouse off

# Decrease command delay (increases vim responsiveness)
set -sg escape-time 10

# Increase repeat time for repeatable commands
set -g repeat-time 1000

# Start window index at 1 instead of 0
set -g base-index 1

# Start pane index at 1 instead of 0
set -g pane-base-index 1

# Highlight window when it has new activity
setw -g monitor-activity on
set -g visual-activity on

# Re-number windows when one is closed
set -g renumber-windows on

set-option -g set-titles on
set-option -g set-titles-string '#{session_name} - #{host}'

# Enable pbcopy and pbpaste
# https://github.com/ChrisJohnsen/tmux-MacOSX-pasteboard/blob/master/README.md
# set-option -g default-command "reattach-to-user-namespace -l zsh"

# End Configuration }}}


# Key Bindings {{{
# Set - for vertical split and | for horizontal split
# -r indicates repeat
# meaning we can press prefix then
# Tap H, J, K, or L continously

# Remap prefix to <C-a>
set -g prefix C-a
unbind C-b
bind C-a send-prefix

unbind %
unbind '"'

bind | split-window -h -c '#{pane_current_path}'
bind - split-window -v -c '#{pane_current_path}'

# Switch panes with hjkl
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Quick window selection
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Resize panes
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Quickly switch panes
unbind ^J
bind ^J select-pane -t :.+

# <C-l> doesn't work in tmux navigator
# so this provides an alternative
bind C-l send-keys 'C-l'


# vim-like pane switching
# bind -r k select-pane -U
# bind -r j select-pane -D
# bind -r h select-pane -L
# bind -r l select-pane -R

# vim-like pane resizing; 5px increments
# bind -r C-k resize-pane -U 5
# bind -r C-j resize-pane -D 5
# bind -r C-h resize-pane -L 5
# bind -r C-l resize-pane -R 5

# Unbind keys because we ain't gonna use em anymore
unbind Up
unbind Down
unbind Left
unbind Right

# Unbind these as well
unbind C-Up
unbind C-Down
unbind C-Left
unbind C-Right

# Reload tmux config
bind r source-file ~/.tmux.conf \; display "Reloaded tmux config!"


# End Key Bindings }}}


# Status Bar {{{

# Enable UTF-8 Support in status bar
set -gq status-utf8 on

# Set refresh interval
set -g status-interval 30

# Center the status bar
# set -g status-justify centre

# Show session, window, pane in left status bar
set -g status-left-length 40
# set -g status-left '#[fg=green] #S #[fg=yellow]#I/#[fg=cyan]#P '
set -g status-left '#[fg=green]tmux: [#P] '


# Show hostname, date, tim 100
set -g status-right '#[fg=yellow] #H #[fg=cyan] %d %b %R '


# Update status bar info
set -g status-interval 60

## }}}


# Colors {{{

# Color status bar
set -g status-style fg=white,bg=colour235

# Color of message bar
set -g message-style fg=white,bold,bg=cyan

# Highlight current window
setw -g window-status-style fg=cyan,bg=colour235
setw -g window-status-current-style fg=white,bold,bg=colour015

# Set color of active pane
set -g pane-border-style fg=colour240,bg=black
set -g pane-active-border-style fg=cyan,bg=black


## }}}


# From https://github.com/tmux-plugins/tpm#installation
# Put at the bottom of the conf
# List of plugins
# Install: Prefix + I
# Update: Prefix + U
# Remove: Prefix + Alt + U
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Install custom plugins here
# set -g @plugin 'odedlaz/tmux-onedark-theme'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# set -g @continuum-restore 'on'
# set -g @continuum-boot-options 'iterm'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'
